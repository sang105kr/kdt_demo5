<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">상품 상세</title>
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/products/detail.css}">
</head>
<body>
    <!-- Layout Fragment -->
    <div th:replace="~{fragment/layout::layout(
        title=${title},
        styles='',
        scripts='',
        style='',
        script='',
        top='~{fragment/top::top}',
        banner='~{fragment/banner::banner}',
        gnb='~{fragment/menu::gnb}',
        main='~{::main}',
        footer='~{fragment/footer::footer}'
    )}">
    </div>

    <!-- Main Content -->
    <main th:fragment="main">
        <div class="product-detail-container">
            <!-- 상품 정보 -->
            <div class="product-detail">
                <!-- 상품 이미지 -->
                <div class="product-image-section">
                    <div class="main-image">
                        <img th:if="${product.imageUrl}" 
                             th:src="@{${product.imageUrl}}" 
                             th:alt="${product.pname}"
                             class="product-main-img">
                        <div th:unless="${product.imageUrl}" class="product-img-placeholder">
                            <span>이미지 없음</span>
                        </div>
                    </div>
                </div>

                <!-- 상품 정보 -->
                <div class="product-info-section">
                    <div class="product-header">
                        <h1 class="product-name" th:text="${product.pname}">상품명</h1>
                        <div class="product-category">
                            <span class="category-tag" th:text="${product.category}">카테고리</span>
                        </div>
                    </div>

                    <!-- 평점 -->
                    <div class="product-rating">
                        <div class="stars">
                            <span th:each="i : ${#numbers.sequence(1, 5)}" 
                                  th:class="${i <= product.rating ? 'star filled' : (i - 0.5 <= product.rating ? 'star half' : 'star')}">
                                ★
                            </span>
                        </div>
                        <span class="rating-text" th:text="${product.rating} + '점'">0.0점</span>
                    </div>

                    <!-- 가격 -->
                    <div class="product-price">
                        <span class="price-amount" th:text="${#numbers.formatInteger(product.price, 3, 'COMMA')} + '원'">0원</span>
                    </div>

                    <!-- 재고 정보 -->
                    <div class="product-stock">
                        <span class="stock-label">재고:</span>
                        <span class="stock-amount" th:text="${product.stockQuantity} + '개'">0개</span>
                        <span th:if="${product.stockQuantity <= 0}" class="out-of-stock">품절</span>
                    </div>

                    <!-- 구매 버튼 -->
                    <div class="purchase-actions">
                        <div class="quantity-selector" th:if="${product.stockQuantity > 0}">
                            <label for="quantity">수량:</label>
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn minus-btn" onclick="decreaseQuantity()">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <input type="number" id="quantity" value="1" min="1" 
                                       th:max="${product.stockQuantity}" class="quantity-input">
                                <button type="button" class="quantity-btn plus-btn" onclick="increaseQuantity()">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        
                        <button th:if="${product.stockQuantity > 0}" 
                                class="btn btn-primary add-to-cart-btn"
                                th:onclick="'addToCart(' + ${product.productId} + ')'">
                            <i class="fas fa-shopping-cart"></i> 장바구니 담기
                        </button>
                        <button th:if="${product.stockQuantity > 0}" 
                                class="btn btn-secondary buy-now-btn"
                                th:onclick="'buyNow(' + ${product.productId} + ')'">
                            <i class="fas fa-credit-card"></i> 바로 구매
                        </button>
                        <button th:if="${product.stockQuantity <= 0}" 
                                class="btn btn-disabled" disabled>
                            품절
                        </button>
                    </div>

                    <!-- 상품 설명 -->
                    <div class="product-description">
                        <h3 class="description-title">상품 설명</h3>
                        <p class="description-text" th:text="${product.description}">상품 설명</p>
                    </div>

                    <!-- 매뉴얼 다운로드 -->
                    <div th:if="${product.manualUrl}" class="product-manual">
                        <h3 class="manual-title">제품 매뉴얼</h3>
                        <a th:href="@{${product.manualUrl}}" 
                           class="manual-download-btn"
                           download>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7,10 12,15 17,10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            매뉴얼 다운로드
                        </a>
                    </div>
                </div>
            </div>

            <!-- 관련 상품 -->
            <div class="related-products">
                <h3 class="related-title">같은 카테고리 상품</h3>
                <div class="related-grid">
                    <!-- 여기에 관련 상품들이 동적으로 로드됩니다 -->
                </div>
            </div>

            <!-- 에러 메시지 -->
            <div th:if="${errorMessage}" class="error-message" th:text="${errorMessage}"></div>
        </div>
    </main>

    <script th:src="@{/js/common.js}"></script>
    <script th:src="@{/js/products/detail.js}"></script>
</body>
</html> 