<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragment/layout::main(
      ~{::title},       
      ~{::link},
      ~{::script},
      ~{},
      ~{::top},         
      ~{::banner},      
      ~{::gnb},         
      ~{::main},        
      ~{::footer}       
      )}">
<head>
  <title th:fragment="title">상담 히스토리 상세 - KDT Demo</title>
  <link rel="stylesheet" href="/css/admin/chat/historyDetail.css">
  <script defer src="/js/admin/chat/historyDetail.js"></script>
</head>
<body>
  <!-- 상단 메뉴 -->
  <th:block th:fragment="top">
    <nav class="topmenu" th:insert="~{fragment/top::topmenu}"/>
  </th:block>

  <!-- 배너 -->
  <th:block th:fragment="banner">
    <header class="head" th:insert="~{fragment/banner::global}"/>
  </th:block>
  
  <!-- GNB -->
  <th:block th:fragment="gnb">
    <nav class="gnb" th:insert="~{fragment/menu::gnbmenu}"/>
  </th:block>
  
  <!-- 본문 -->
  <th:block th:fragment="main">
    <main class="main">
      <div class="history-detail-container">
        <!-- 히스토리 헤더 -->
        <div class="history-header">
          <div class="header-left">
            <a href="/admin/chat/history" class="back-btn">
              <i class="fas fa-arrow-left"></i>
              히스토리 목록으로
            </a>
            <div class="session-info">
              <h1 class="session-title" id="sessionTitle">상담 히스토리</h1>
              <div class="session-meta">
                <span class="customer-name" id="customerName">고객명</span>
                <span class="session-status completed">완료</span>
                <span class="session-time" id="sessionTime">-</span>
              </div>
            </div>
          </div>
          <div class="header-right">
            <div class="session-actions">
              <span class="status-badge completed">완료된 상담</span>
            </div>
          </div>
        </div>

        <!-- 메인 콘텐츠 영역 -->
        <div class="history-main-content">
          <!-- 메시지 영역 -->
          <div class="chat-messages" id="messageArea">
            <div class="loading" id="loadingMessages">
              <i class="fas fa-spinner fa-spin"></i>
              메시지를 불러오는 중...
            </div>
            <!-- 메시지들이 여기에 동적으로 추가됨 -->
          </div>
        </div>

        <!-- 상담 정보 사이드바 -->
        <div class="session-sidebar">
          <div class="sidebar-header">
            <h3>상담 정보</h3>
          </div>
          
          <div class="sidebar-content">
            <div class="info-section">
              <h4>고객 정보</h4>
              <div class="info-item">
                <span class="label">이름:</span>
                <span class="value" id="sidebarCustomerName">-</span>
              </div>
              <div class="info-item">
                <span class="label">이메일:</span>
                <span class="value" id="sidebarCustomerEmail">-</span>
              </div>
              <div class="info-item">
                <span class="label">연락처:</span>
                <span class="value" id="sidebarCustomerPhone">-</span>
              </div>
            </div>
            
            <div class="info-section">
              <h4>상담 정보</h4>
              <div class="info-item">
                <span class="label">시작 시간:</span>
                <span class="value" id="sidebarStartTime">-</span>
              </div>
              <div class="info-item">
                <span class="label">종료 시간:</span>
                <span class="value" id="sidebarEndTime">-</span>
              </div>
              <div class="info-item">
                <span class="label">메시지 수:</span>
                <span class="value" id="sidebarMessageCount">0</span>
              </div>
              <div class="info-item">
                <span class="label">상담원:</span>
                <span class="value" id="sidebarAdminName">-</span>
              </div>
              <div class="info-item">
                <span class="label">카테고리:</span>
                <span class="value" id="sidebarCategoryName">-</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </th:block>
  
  <!-- 푸터 -->
  <th:block th:fragment="footer">
    <footer class="foot" th:insert="~{fragment/footer::global}"/>
  </th:block>
</body>
</html>
